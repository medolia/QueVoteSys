<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
        xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vote Page</title>
</head>
<body>

<h1>Demonstration How You Like the Game: <em>Sekiro</em></h1>
<p class="vote-timer-container">Remaining time: <span class="vote-timer">20</span> second</p>
<hr>

<form th:action="@{/votepost}" method="POST">

    <div class="grid">
        <div class="questionList">
            <div th:each="optionsForAQ : ${optionsMap}">
                <h3 th:text="${optionsForAQ.key.question_name}">QUESTION NAME HERE</h3>
                <br>
                <div class="optionList" th:each="option : ${optionsForAQ.value}">
                    <input type="radio" class="option-radio" th:id="'question' + ${optionsForAQ.key.id} + 'option' + ${option.id}" th:name="${optionsForAQ.key.id}+ '#' +${optionsForAQ.key.question_name}" th:value="${option.id}+ '#' +${option.option_content}" >
                    <label th:for="'question' + ${optionsForAQ.key.id} + 'option' + ${option.id}" th:text="${option.option_content}">OPTION HERE</label>
                </div>
                <hr>
            </div>
            <div class="cntBtn">
                <input class="form-submit-btn" type="submit" value="提交">
                <input type="reset" value="重置">
            </div>
        </div>
    </div>

</form>

</body>
<script th:src="@{/js/query-3.5.1.min.js}" type="text/javascript"></script>
<script type="text/javascript">

    $(function() {

        const voteTimer = setInterval(function () {
            let currentTime = $(".vote-timer").text();
            $(".vote-timer").text(parseInt(currentTime) - 1);
        }, 1000);

        const voteTimeout = setTimeout(cancelVoteAccess, 20000);

        let now = new Date().getTime();
        let startTime = localStorage.getItem("startTime");

        if (localStorage.getItem("startTime") == null) {
            localStorage.setItem("startTime", now);
        } else {
            if ((now - startTime) >= 20000) {
                $(".vote-timer").text(0);
                cancelVoteAccess();
                localStorage.removeItem("startTime");
            }
        }

        function cancelVoteAccess() {
            clearInterval(voteTimer);
            $(".form-submit-btn").attr("disabled", "disabled");
        };



    });

</script>


</html>