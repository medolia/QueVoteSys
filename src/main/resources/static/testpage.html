<!DOCTYPE html>
<html lang="en">
<head>
    <title>Bootstrap Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>
<body>

<!--<span class="option0">Que Melodia</span>
<span class="option0">0</span>
<span class="option2">0</span>
<p class="vote-timer-container">Remaining time: <span class="vote-timer">20</span> second</p>
<input class="form-submit-btn" type="submit" value="提交">-->

<!--<div class="container my-5 text-center">
    <div class="jumbotron border border-success">
        <h1>Vote for the Game: <strong>Sekiro</strong></h1>
        <p class="text-secondary">show your view relating to this game about</p>
        <ul class="list-group list-group-horizontal justify-content-center">
            <li class="list-group-item">FREEDOM</li>
            <li class="list-group-item">PICTURE QUALITY</li>
            <li class="list-group-item">STORY NARRATIVE</li>
            <li class="list-group-item">PHILOSOPHY OF ART</li>
        </ul>
        <a href="" class="mt-5 btn btn-success" role="button">Customize My Options</a>

    </div>
</div>-->

<div class="progress">
    <div class="progress-bar bg-info progress-bar-striped progress-bar-animated" id="vote-timer" style="width: 100%;"></div>
</div>

</body>

<script type="text/javascript">

    $(function() {

        let remainingTime = 100;
        const voteTimer = setInterval(function () {
            remainingTime -= 10;
            $("#vote-timer").attr("style", "width:" + remainingTime.toString() +"%;");
        }, 1000);

        /*const voteTimeout = setTimeout(cancelVoteAccess, 20000);

        let now = new Date().getTime();
        let startTime = localStorage.getItem("startTime");

        if (localStorage.getItem("startTime") == null) {
            localStorage.setItem("startTime", now);
        } else {
            if ((now - startTime) >= 20000) {
                $(".vote-timer").text(0);
                cancelVoteAccess();
                localStorage.removeItem("startTime");
            }
        }

        function cancelVoteAccess() {
            clearInterval(voteTimer);
            $(".form-submit-btn").attr("disabled", "disabled");
        };*/



    });

</script>
<!--<script type="text/javascript">



    $(document).ready(function() {
        $.ajax({
            type: "GET",
            url: "http://localhost:8080/results",
            // contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                let tempVal = $("span.option2").text();
                let tempNum = parseInt(tempVal);
                console.log(tempVal + " -> " + (tempNum+1).toString());
                $("span.option2").text(tempNum);
                let option_id = 0;
                let voteNum = 0;
                $.each(data, function (i, answer) {
                    option_id = answer["option_id"];
                    /*voteNum =  $(".option0").text();
                    console.log(voteNum);*/
                    voteNum = $(".option" + option_id ).text();
                    // console.log(voteNum);
                    $("#option" + option_id).text(voteNum.toString());
                });
            },
            error: function (result) {
                alert(result.responseText);
            }
        });
    });

</script>-->
<!--<script type="text/javascript">

    $(document).ready(function() {
        $.ajax({
            type: "GET",
            url: "http://localhost:8080/results",
            // contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                let option_id = 0;
                let optNumSumList = [];
                $.each(data, function (index, answer) {
                    option_id = answer["option_id"];
                    let optNotExsit =  optUpdate(option_id, optNumSumList);
                    if (optNotExsit) {
                        optNumSumList.push(new OptNumSum((option_id, 1)));
                    }
                });

                $.each(optNumSumList, function (index, optNumSum) {
                    $("#option" + optNumSum.option_id).text(optNumSum.voteNum);
                })

            },
            error: function (result) {
                alert(result.responseText);
            }
        });
    });

    function OptNumSum(option_id, voteNum) {
        this.option_id = option_id;
        this.voteNum = voteNum;
    }

    function optUpdate(option_id, optNumSumList) {
        optNumSumList.forEach(function(value, index) {
            if (value.option_id == option_id) {
                value.voteNum += 1;
                return false;
            }
        });

        return true;
    }

</script>-->

</html>